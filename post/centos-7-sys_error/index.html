<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title> CentOS 7 重启某个服务报错 | Tsui</title>
<link rel="shortcut icon" href="https://YaoyaoTsui.github.io/favicon.ico?v=1618071333910">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://YaoyaoTsui.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title=" CentOS 7 重启某个服务报错 | Tsui - Atom Feed" href="https://YaoyaoTsui.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="
错误信息：
Authorization not available. Check if polkit service is running or see debug message for more information.
参考链接：
..." />
    <meta name="keywords" content="Linux" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://YaoyaoTsui.github.io">
  <img class="avatar" src="https://YaoyaoTsui.github.io/images/avatar.png?v=1618071333910" alt="">
  </a>
  <h1 class="site-title">
    Tsui
  </h1>
  <p class="site-description">
    温故而知新
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          Home
        </a>
      
    
      
        <a href="/archives" class="menu">
          Archieves
        </a>
      
    
      
        <a href="/tags" class="menu">
          Tags
        </a>
      
    
      
        <a href="/post/about" class="menu">
          About
        </a>
      
    
  </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
               CentOS 7 重启某个服务报错
            </h2>
            <div class="post-info">
              <span>
                2021-04-11
              </span>
              <span>
                3 min read
              </span>
              
                <a href="https://YaoyaoTsui.github.io/tag/62jeyR1oN/" class="post-tag">
                  # Linux
                </a>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <blockquote>
<p>错误信息：<br>
Authorization not available. Check if polkit service is running or see debug message for more information.<br>
参考链接：<br>
https://www.icode9.com/content-3-715773.html<br>
https://access.redhat.com/solutions/1543343</p>
</blockquote>
<p>解决方案：</p>
<ol>
<li>根据提示查看polkit状态</li>
</ol>
<pre><code>systemctl status polkit
</code></pre>
<blockquote>
<p>如果发现polkit的状态是faild，检查系统已安装polkit并手动启动它</p>
</blockquote>
<ol start="2">
<li>检查是否安装了polkit</li>
</ol>
<pre><code class="language-shell">yum list installed | grep polkit
</code></pre>
<ol start="3">
<li>安装 polkit</li>
</ol>
<pre><code class="language-shell">yum install polkit
</code></pre>
<ol start="4">
<li>启动polkit</li>
</ol>
<pre><code class="language-shell">systemctl start polkit
</code></pre>
<blockquote>
<p>手动启动仍然是此错误，那么执行以下操作！</p>
</blockquote>
<ol start="5">
<li><strong>确保存在<code>polkitd</code>系统用户和组</strong></li>
</ol>
<pre><code class="language-shell"># 将以下2个复合命令复制/粘贴到终端以检查并有条件地创建用户/组
getent group polkitd &gt;/dev/null &amp;&amp; echo -e &quot;\e[1;32mpolkitd group already exists\e[0m&quot; || { groupadd -r polkitd &amp;&amp; echo -e &quot;\e[1;33mAdded missing polkitd group\e[0m&quot; || echo -e &quot;\e[1;31mAdding polkitd group FAILED\e[0m&quot;; }
getent passwd polkitd &gt;/dev/null &amp;&amp; echo -e &quot;\e[1;32mpolkitd user already exists\e[0m&quot; || { useradd -r -g polkitd -d / -s /sbin/nologin -c &quot;User for polkitd&quot; polkitd &amp;&amp; echo -e &quot;\e[1;33mAdded missing polkitd user\e[0m&quot; || echo -e &quot;\e[1;31mAdding polkitd user FAILED\e[0m&quot;; }
</code></pre>
<ol start="6">
<li><strong>重置<code>polkit</code>和<code>polkit-pkla-compat</code>程序包提供的所有文件的权限和用户/组所有权</strong></li>
</ol>
<pre><code class="language-shell"># 将以下命令复制/粘贴到终端，以检查并有条件地重置用户/组权限和所有权

rpm -Va polkit\* &amp;&amp; echo -e &quot;\e[1;32mpolkit* rpm verification passed\e[0m&quot; || { echo -e &quot;\e[1;33mResetting polkit* rpm user/group ownership &amp; perms\e[0m&quot;; rpm --setugids polkit polkit-pkla-compat; rpm --setperms polkit polkit-pkla-compat; }
</code></pre>
<ol start="7">
<li>重启系统</li>
</ol>
<pre><code>reboot
</code></pre>
<p>再次重启服务，OK！</p>
<p>补充：</p>
<blockquote>
<p>polkit是一个应用程序级别的工具集，通过定义和审核权限规则，实现不同优先级进程间的通讯。</p>
<p>控制决策集中在同一的框架之中，决定低优先级进程是否有权访问高优先级进程</p>
<p>polkit在系统层级进行权限控制，提供了一个低优先级进程和高优先级进程进行通信的系统</p>
<p>在使用systemcd 225的时候会有这类错误异常bug，但是到systemd 229的时候修复了。错误原因是当systemd启动了这个服务的时候policykit -1的postions杀掉了polkit的守护进程。在RHEL,CentOS,ubuntu,debain系统上均可以看到相关bug报告反馈。</p>
</blockquote>

              </div>
              <div class="toc-container">
                
              </div>
            </div>
          </article>
        </div>

        

        

        <div class="site-footer">
  Powered by <a href="https://github.com/YaoyaoTsui" target="_blank">Tsui</a>
  <a class="rss" href="https://YaoyaoTsui.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
