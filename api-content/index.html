{"posts":[{"title":"Security Onion两种方式安装","content":" 基于CentOS 7 下载地址：https://github.com/Security-Onion-Solutions/securityonion/blob/master/VERIFY_ISO.md 安装文档：https://docs.securityonion.net/en/2.3/installation.html#installation-using-security-onion-iso-image 参考文档：https://www.freebuf.com/articles/ics-articles/248260.html 一、安装环境要求 内存：至少12G 硬盘：200G CPU：4核 网卡：2块 系统：CentOS 7 二、准备安装 2.1 方式一：空机ISO安装 下载ISO镜像文件 创建虚拟机 开启虚拟机准备安装系统，输入yes，之后创建安全洋葱系统账号，我这里创建的账号密码为:onion/admin.123 安装完成重启系统后，输入用户名和密码登录系统onion/admin123 弹出security onion安装界面，按照指引进行安装 安装完成后，登录系统配置web登录 这个时候就可以使用该地址进行登录web端管理了 2.2 方式二：基于系统在线安装 Installation on Ubuntu or CentOS 下载安装git 克隆security onion 执行安装 界面操作与ISO安装雷同 2.2.1 问题： 由于是使用的在线安装的方式，所以前提就是保证自己的系统可以访问网络，且域名解析系统正常使用！ 一直卡在26%进度或某一进度（下载某些软件阶段：例如so-acng） 出现kernel:NMI watchdog: BUG: soft lockup - CPU#2 stuck for 28s类似问题 内核软死锁（soft lockup）bug原因分析： Soft lockup名称解释：所谓，soft lockup就是说，这个bug没有让系统彻底死机，但是若干个进程（或者kernel thread）被锁死在了某个状态（一般在内核区域），很多情况下这个是由于内核锁的使用的问题。 Linux内核对于每一个cpu都有一个监控进程，在技术界这个叫做watchdog（看门狗）。通过ps –ef | grep watchdog能够看见，进程名称大概是watchdog/X（数字：cpu逻辑编号1/2/3/4之类的）。这个进程或者线程每一秒钟运行一次，否则会睡眠和待机。这个进程运行会收集每一个cpu运行时使用数据的时间并且存放到属于每个cpu自己的内核数据结构。在内核中有很多特定的中断函数。这些中断函数会调用soft lockup计数，他会使用当前的时间戳与特定（对应的）cpu的内核数据结构中保存的时间对比，如果发现当前的时间戳比对应cpu保存的时间大于设定的阀值，他就假设监测进程或看门狗线程在一个相当可观的时间还没有执。Cpu软锁为什么会产生，是怎么产生的？如果linux内核是经过精心设计安排的CPU调度访问，那么怎么会产生cpu软死锁？那么只能说由于用户开发的或者第三方软件引入，看我们服务器内核panic的原因就是qmgr进程引起。因为每一个无限的循环都会一直有一个cpu的执行流程（qmgr进程示一个后台邮件的消息队列服务进程），并且拥有一定的优先级。Cpu调度器调度一个驱动程序来运行，如果这个驱动程序有问题并且没有被检测到，那么这个驱动程序将会暂用cpu的很长时间。根据前面的描述，看门狗进程会抓住（catch）这一点并且抛出一个软死锁（soft lockup）错误。软死锁会挂起cpu使你的系统不可用。 解决办法： 参考：https://www.cnblogs.com/fusheng11711/p/10767190.html 实测：无用！！！ ","link":"https://YaoyaoTsui.github.io/post/securityonion_install/"},{"title":"CentOS 7装Oracle11gR2","content":"一、环境支持 CentOS 7 内存至少2G swap建议3G 磁盘大约40G Oracle安装包：版本11gR2 linux.x64_11gR2_database_1of2.zip linux.x64_11gR2_database_2of2.zip 二、安装环境准备 2.1 创建运行racle数据库的系统用户和用户组 为啥要创建oinstall用户组及dba组？ 参考：http://www.oracle.com/technetwork/cn/articles/hunter-rac11gr2-iscsi-2-092412-zhs.html#13 理论上单例按照需要3种用户组，实际只建两个oinstall和dba，后面再安装oracle数据库的时候把OSOPER组也设置是dba组。 2.2 创建oracle数据库安装目录 2.3 修改OS系统标识 2.4 安装Oracle数据库所需要的软件包 yum install -y ksh binutils compat-libstdc++-33 elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc-common glibc-devel libaio libaio-devel libgcc libstdc++ libstdc++-devel make numactl sysstat libXp unixODBC unixODBC-devel 若遇到无法安装pdksh，可以下载对应rpm包进行安装 2.5 关闭防火墙、关闭selinux 2.6 修改内核参数 2.7 对oracle用户设置限制，提高软件运行性能 2.8 配置用户的环境变量 2.9 解压安装包 三、安装Oracle（图形化界面安装） 3.1 图形界面登陆oracle用户： 3.2 启动oralce安装 会弹出Oracle的安装图形化界面 安装时遇到问题： swap空间不够问题 要求大约在2.67G，实际上只有2G 检查package 之前没有安装的，此时安装，多检查几次 3.3 配置监听 ","link":"https://YaoyaoTsui.github.io/post/centos-7-zhuang-oracle11gr2/"},{"title":" CentOS 7 重启某个服务报错","content":" 错误信息： Authorization not available. Check if polkit service is running or see debug message for more information. 参考链接： https://www.icode9.com/content-3-715773.html https://access.redhat.com/solutions/1543343 解决方案： 根据提示查看polkit状态 如果发现polkit的状态是faild，检查系统已安装polkit并手动启动它 检查是否安装了polkit 安装 polkit 启动polkit 手动启动仍然是此错误，那么执行以下操作！ 确保存在polkitd系统用户和组 重置polkit和polkit-pkla-compat程序包提供的所有文件的权限和用户/组所有权 重启系统 再次重启服务，OK！ 补充： polkit是一个应用程序级别的工具集，通过定义和审核权限规则，实现不同优先级进程间的通讯。 控制决策集中在同一的框架之中，决定低优先级进程是否有权访问高优先级进程 polkit在系统层级进行权限控制，提供了一个低优先级进程和高优先级进程进行通信的系统 在使用systemcd 225的时候会有这类错误异常bug，但是到systemd 229的时候修复了。错误原因是当systemd启动了这个服务的时候policykit -1的postions杀掉了polkit的守护进程。在RHEL,CentOS,ubuntu,debain系统上均可以看到相关bug报告反馈。 ","link":"https://YaoyaoTsui.github.io/post/centos7重启某服务失败/"}]}